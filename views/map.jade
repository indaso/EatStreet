extends layout

block content
  h1= title
  p Welcome to #{title}
  div#mapholder
  script(src="http://maps.google.com/maps/api/js?sensor=false")
  script.
    window.onload = function() {
      getLocation();
    }
    function getLocation() {
      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(showPosition);
      } else {
        console.log("Geolocation is not supported by this browser.");
      }
    }
    function showPosition(position) {
      lat = #{centerX};
      lon = #{centerY};

      latlon = new google.maps.LatLng(lat, lon)
      mapholder = document.getElementById('mapholder')
      mapholder.style.height = '250px';
      mapholder.style.width = '500px';

      var myOptions = {
        center:latlon,zoom:14,
        mapTypeId:google.maps.MapTypeId.ROADMAP,
        mapTypeControl:false,
        navigationControlOptions:{style:google.maps.NavigationControlStyle.SMALL}
      }

      var map = new google.maps.Map(document.getElementById("mapholder"), myOptions);
      var marker = new google.maps.Marker({
        position:latlon,
        icon:{path:google.maps.SymbolPath.CIRCLE,scale:10},
        map:map,
        title:"You are here!"
      });

      var coords_arr = "#{coords}";
      console.log(coords_arr);
      var markers = [];
      coords_arr = JSON.parse(coords_arr);


      for(var i = 0; i < coords_arr.length; i++) {
        coordinates = "" + coords_arr[i];
        lat = coordinates.split(",")[0];
        lon = coordinates.split(",")[1];

        latlon = new google.maps.LatLng(lat, lon);
        var surrounding = new google.maps.Marker({position:latlon,map:map,title:"You are here!"});
        markers.push(surrounding);
      }

      for(var i = 0; i < markers.length; i++) {
        markers[i].setMap(map);
      }


    }


